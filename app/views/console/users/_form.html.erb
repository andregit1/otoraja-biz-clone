<div class="card-body">

  <% if user.errors.any? %>
  <div class="callout callout-danger">
    <h2><%= pluralize(user.errors.count, "error") %> prohibited this User from being saved:</h2>
    <ul>
      <% user.errors.full_messages.each do |message| %>
      <li><%= message %></li>
      <% end %>
    </ul>
  </div>
  <% end %>

  <% if user.role == 'owner' %>
    <div class="form-group">
      <%= f.label :email, 'Email' %>
      <% if controller.action_name.in?(['new', 'create']) %>
        <%= f.text_field :email, :class=>'form-control', autocomplete: 'new-password' %>
      <% else %>
        <div><%= user.email %></div>
      <% end %>
    </div>
  <% else %>
    <div class="form-group">
      <%= f.label :user_id, 'User ID' %>
      <% if controller.action_name.in?(['new', 'create']) %>
      <%= f.text_field :user_id, :class=>'form-control', autocomplete: 'new-password' %>
      <% else %>
      <div><%= user.user_id %></div>
      <% end %>
    </div>
  <% end %>

  <div class="form-group">
    <%= f.label :name, 'Name' %>
    <%= f.text_field :name, :class=>'form-control', autocomplete: 'new-password' %>
  </div>

  <% unless controller.action_name.in?(['edit', 'update']) %>
  <div class="form-group">
    <%= f.label :password, 'Password' %>
    <%= f.password_field :password, :class=>'form-control', autocomplete: 'new-password' %>
  </div>
  <% end %>

  <div class="form-group">
    <%= f.label :role, 'Role' %>
    <% if @user.role.present? %>
    <div><%= @user.role %><%= f.hidden_field :role %></div>
    <% else %>
    <%= f.select :role, @roles, {:include_blank => true}, {:class=>'form-control select2'} %>
    <% end %>
  </div>

  <div class="form-group">
    <%= f.label :available_shops, 'Available Shops' %>
    <div class="available-shop-box mb-2">
      <%= f.collection_select :shop_ids, Shop.all, :id, :id_name, {prompt: "Please Select a Sector"}, {class: 'shop_select form-control', multiple: true} %>
    </div>
  </div>
  

  <% if current_user.admin? %>
  <%= f.label :export_pattern_id, 'Export Pattern' %>
  <%= f.collection_select :export_pattern_id, ExportPattern.all, :id, :name, { :include_blank => true }, { :class=>'form-control mr-2' } %>
  <% end %>

  <% if controller.action_name.in?(['new', 'create']) %>
    <%= f.hidden_field :status, :value=>'enabled' %>
  <% else %>
    <%= f.hidden_field :status %>
  <% end %>
</div>

<div class="card-footer">
  <div class="row">
    <div class="col text-right">
      <% if controller.action_name.in?(['new', 'create']) %>
        <% if @shop_id.present? %>
          <%= link_to 'Back', console_shop_path(id: @shop_id), class: 'btn btn-default btn-lg' %>
        <% else %>
          <%= link_to 'Back', console_users_path, class: 'btn btn-default btn-lg' %>
        <% end %>
        <%= f.submit 'Regist', :class=>'btn btn-primary btn-lg' %>
      <% else %>
        <%= link_to 'Back', console_users_path, class: 'btn btn-default btn-lg' %>
        <%= f.submit 'Update', :class=>'btn btn-primary btn-lg' %>
      <% end %>
    </div>
  </div>
</div>

<%= f.hidden_field :shop_id, :value=>@shop_id %>
<%= f.hidden_field :referrer, :value=>@referrer %>
